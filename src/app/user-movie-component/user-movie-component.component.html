<body>
  <div class="movie-container">
    <div class="poster" [ngStyle]="{'background-image': 'url(' + selectedMovie.imageUrl + ')'}"></div>
    <div class="details">
      <h1>{{ selectedMovie.movieName }}</h1>
      <p>{{ selectedMovie.movieDescription }}</p>
      <div style="display: flex; align-items: center; margin-bottom: 15px;">
        <p style="margin-right: 20px;">Release Date: {{ selectedMovie.movieReleaseDate }}</p>
        <p style="margin-right: 20px;">Director: {{ selectedMovie.movieDirector }}</p>
        <p>Genre: {{ selectedMovie.movieGenre }}</p>
      </div>
      <div>
        <p>Language: {{ selectedMovie.movieLanguage }}</p>
        <p>Duration: {{ selectedMovie.duration }}</p>
        <p>Overall Rate: {{ selectedMovie.overallRate }}</p>
      </div>
      <div class="box1">
        <div class="box">
          <h1 class="text-center" alt="Simple"></h1>
          <button class="add-rating-button" data-toggle="modal" data-target="#ratingModal">
            <span class="star">&#9733;</span>Add Rating
          </button>
        </div>
      </div>
      <div class="review-container">
        <p id="review-text"></p>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="ratingModal" tabindex="-1" role="dialog" aria-labelledby="ratingModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="ratingModalLabel">Add your Rating</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="box2">
            <div class="starrating risingstar d-flex justify-content-center flex-row-reverse">
              <input type="radio" [(ngModel)]="starValue" id="star10" name="rating" value="10" /><label for="star10" title="10 star">10</label>
              <input type="radio" [(ngModel)]="starValue" id="star9" name="rating" value="9" /><label for="star9" title="9 star">9</label>
              <input type="radio" [(ngModel)]="starValue" id="star8" name="rating" value="8" /><label for="star8" title="8 star">8</label>
              <input type="radio" [(ngModel)]="starValue" id="star7" name="rating" value="7" /><label for="star7" title="7 star">7</label>
              <input type="radio" [(ngModel)]="starValue" id="star6" name="rating" value="6" /><label for="star6" title="6 star">6</label>
              <input type="radio" [(ngModel)]="starValue" id="star5" name="rating" value="5" /><label for="star5" title="5 star">5</label>
              <input type="radio" [(ngModel)]="starValue" id="star4" name="rating" value="4" /><label for="star4" title="4 star">4</label>
              <input type="radio" [(ngModel)]="starValue" id="star3" name="rating" value="3" /><label for="star3" title="3 star">3</label>
              <input type="radio" [(ngModel)]="starValue" id="star2" name="rating" value="2" /><label for="star2" title="2 star">2</label>
              <input type="radio" [(ngModel)]="starValue" id="star1" name="rating" value="1" /><label for="star1" title="1 star">1</label>
              <div class="half-star"></div>
            </div>
          </div>
          <h3>Add your review</h3>
          <textarea [(ngModel)]="reviewMessage" class="input-box"></textarea><br>
        </div>
        <div class="modal-footer">
          <button type="button" class="submit-button btn btn-primary" (click)="submitReview()">Submit</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="clearAllData()">Close</button>
        </div>
      </div>
    </div>
  </div>

  <h2>Reviews</h2>
  <div class="user-reviews">
    <div *ngFor="let review of userReviews" class="user-review">
     
      <h3>{{ review.username }}</h3>
      <p>{{ review.review }}</p>
    </div>
  </div>



  <script>
    function submitReview() {
      const rating = getStarRating();
      const reviewText = document.querySelector('.input-box').value;
      document.getElementById('review-text').innerText = `Rating: ${rating}\nReview: ${reviewText}`;
      updateStarRating(rating);
      // Close the modal
      $('#ratingModal').modal('hide');
    }

    function clearAllData() {
      // Clear rating and review text
      document.querySelector('.input-box').value = '';
      document.getElementById('review-text').innerText = '';
      // Clear star rating
      const starRatingInputs = document.querySelectorAll('.starrating input');
      starRatingInputs.forEach((input) => (input.checked = false));
    }

    function getStarRating() {
      const starRatingInputs = document.querySelectorAll('.starrating input');
      for (let i = 0; i < starRatingInputs.length; i++) {
        if (starRatingInputs[i].checked) {
          return starRatingInputs[i].value;
        }
      }
      return '';
    }

    function updateStarRating(rating) {
      // Update star rating logic
      console.log(`Updating star rating: ${rating}`);
    }
  </script>
</body>
